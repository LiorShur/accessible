/**
 * Access Nature - Mobile Responsiveness Fixes
 * 
 * Comprehensive mobile-first responsive styles for all pages.
 * Breakpoints: 320px (iPhone SE), 375px (iPhone), 390px (iPhone 14), 428px (Pro Max), 768px (iPad)
 */

/* ============================================
   BASE MOBILE FIXES (All screens)
   ============================================ */

/* Prevent horizontal scroll */
html, body {
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

/* Touch-friendly targets (minimum 44x44px) */
button,
a,
input[type="button"],
input[type="submit"],
.clickable,
.tappable {
  min-height: 44px;
  min-width: 44px;
}

/* Prevent text size adjustment on orientation change */
html {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

/* Safe area insets for notched devices */
@supports (padding: env(safe-area-inset-bottom)) {
  .bottom-nav,
  .bottom-panel,
  .floating-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .top-nav,
  .unified-nav {
    padding-top: env(safe-area-inset-top);
  }
}

/* ============================================
   EXTRA SMALL SCREENS (320px - iPhone SE)
   ============================================ */
@media (max-width: 359px) {
  /* Typography scaling */
  html {
    font-size: 14px;
  }
  
  h1 {
    font-size: 1.5rem !important;
  }
  
  h2 {
    font-size: 1.25rem !important;
  }
  
  h3 {
    font-size: 1.1rem !important;
  }
  
  /* Navigation */
  .top-nav,
  .unified-nav {
    padding: 0 8px !important;
  }
  
  .nav-brand {
    font-size: 0.85rem !important;
  }
  
  /* Buttons */
  .btn,
  button {
    padding: 10px 14px !important;
    font-size: 0.85rem !important;
  }
  
  .round-button {
    width: 44px !important;
    height: 44px !important;
    font-size: 1.1rem !important;
  }
  
  /* Cards */
  .card,
  .nav-card,
  .trail-card,
  .stat-card {
    padding: 12px !important;
  }
  
  /* Forms */
  input,
  select,
  textarea {
    font-size: 16px !important; /* Prevents iOS zoom on focus */
    padding: 12px !important;
  }
  
  /* Modals */
  .modal-content,
  .auth-modal-container {
    width: 95vw !important;
    max-width: 95vw !important;
    margin: 8px !important;
    padding: 16px !important;
  }
  
  /* Bottom nav */
  .bottom-nav {
    padding: 8px 4px !important;
  }
  
  .nav-button {
    font-size: 0.75rem !important;
    padding: 8px 6px !important;
  }
  
  /* Feature tags */
  .feature-tag {
    font-size: 0.7rem !important;
    padding: 4px 8px !important;
  }
  
  /* Stats grid */
  .stats-grid {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 8px !important;
  }
  
  .stat-value {
    font-size: 1.25rem !important;
  }
  
  /* Hero section */
  .hero-title {
    font-size: 1.75rem !important;
  }
  
  .hero-subtitle {
    font-size: 0.9rem !important;
  }
}

/* ============================================
   SMALL SCREENS (360px - 389px)
   ============================================ */
@media (min-width: 360px) and (max-width: 389px) {
  html {
    font-size: 15px;
  }
  
  .nav-brand {
    font-size: 0.9rem;
  }
  
  .modal-content,
  .auth-modal-container {
    width: 92vw;
    max-width: 92vw;
  }
}

/* ============================================
   MEDIUM SMALL SCREENS (390px - 427px - iPhone 14)
   ============================================ */
@media (min-width: 390px) and (max-width: 427px) {
  html {
    font-size: 15.5px;
  }
  
  .modal-content,
  .auth-modal-container {
    width: 90vw;
    max-width: 90vw;
  }
}

/* ============================================
   LARGE PHONES (428px - 767px - iPhone Pro Max)
   ============================================ */
@media (min-width: 428px) and (max-width: 767px) {
  html {
    font-size: 16px;
  }
  
  .modal-content,
  .auth-modal-container {
    width: 88vw;
    max-width: 400px;
  }
  
  .nav-card {
    padding: 20px;
  }
}

/* ============================================
   INDEX.HTML SPECIFIC MOBILE FIXES
   ============================================ */
@media (max-width: 767px) {
  /* Hero section */
  .hero-section {
    min-height: auto;
    padding: 60px 16px 40px;
  }
  
  .hero-content {
    padding: 0;
  }
  
  .hero-title {
    font-size: 2rem;
    margin-bottom: 8px;
  }
  
  .hero-subtitle {
    font-size: 1rem;
    margin-bottom: 16px;
  }
  
  /* Main navigation cards */
  .main-navigation {
    padding: 16px;
  }
  
  .nav-container {
    grid-template-columns: 1fr !important;
    gap: 16px;
  }
  
  .nav-card {
    padding: 20px;
  }
  
  .nav-card-icon {
    font-size: 2.5rem;
    margin-bottom: 12px;
  }
  
  .nav-card h2 {
    font-size: 1.25rem;
    margin-bottom: 8px;
  }
  
  .nav-card p {
    font-size: 0.9rem;
    margin-bottom: 16px;
  }
  
  .nav-card-features {
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 16px;
  }
  
  .feature-tag {
    font-size: 0.75rem;
    padding: 4px 10px;
  }
  
  .nav-card-button {
    width: 100%;
    padding: 14px;
    font-size: 1rem;
  }
  
  /* Quick search */
  .quick-search {
    flex-direction: column;
    gap: 8px;
  }
  
  .quick-search input {
    width: 100%;
  }
  
  .quick-search .search-btn {
    width: 100%;
  }
  
  /* Trail browser modal */
  .trail-browser-modal .modal-content {
    width: 100%;
    height: 100%;
    max-height: 100vh;
    border-radius: 0;
    margin: 0;
  }
  
  .filter-grid {
    grid-template-columns: 1fr !important;
    gap: 12px;
  }
  
  .trail-results-grid {
    grid-template-columns: 1fr !important;
  }
  
  /* My trails section */
  .my-trails-section {
    padding: 16px;
  }
  
  .my-trails-grid {
    grid-template-columns: 1fr !important;
  }
  
  /* Footer */
  .footer-links {
    flex-direction: column;
    gap: 12px;
    text-align: center;
  }
}

/* ============================================
   TRACKER.HTML SPECIFIC MOBILE FIXES
   ============================================ */
@media (max-width: 767px) {
  /* Map container - preserve rotation-friendly sizing from layout.css */
  /* The 200%/200% size with -50% offset is needed for rotation without corner clipping */
  /* Only override z-index if needed, don't touch size/position */
  
  /* Top control bar */
  .top-bar {
    top: 55px !important;
    left: 8px !important;
    right: 8px !important;
    padding: 8px 12px !important;
    gap: 8px !important;
    border-radius: 12px !important;
  }
  
  .top-bar .round-button {
    width: 40px !important;
    height: 40px !important;
    font-size: 1rem !important;
  }
  
  .stat-display {
    font-size: 0.9rem !important;
  }
  
  .separator {
    margin: 0 4px !important;
  }
  
  /* Floating controls */
  .floating-left,
  .floating-right {
    gap: 8px !important;
  }
  
  .floating-left {
    left: 8px !important;
    top: 120px !important;
  }
  
  .floating-right {
    right: 8px !important;
    top: 120px !important;
  }
  
  .floating-left .round-button,
  .floating-right .round-button {
    width: 44px !important;
    height: 44px !important;
  }
  
  /* Bottom navigation */
  .bottom-nav {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 60px !important;
    padding: 8px 12px !important;
    gap: 8px !important;
    background: rgba(255, 255, 255, 0.98) !important;
    backdrop-filter: blur(10px) !important;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1) !important;
  }
  
  .nav-button {
    flex: 1 !important;
    padding: 10px 8px !important;
    font-size: 0.8rem !important;
    border-radius: 8px !important;
  }
  
  /* Bottom panels */
  .bottom-popup {
    bottom: 60px !important;
    max-height: 60vh !important;
    border-radius: 16px 16px 0 0 !important;
  }
  
  /* Compass - keep at 36x36 */
  #compass {
    width: 36px !important;
    height: 36px !important;
  }
  
  /* Weather widget */
  .weather-container {
    top: 55px !important;
    right: 8px !important;
    max-width: 150px !important;
    font-size: 0.8rem !important;
  }
  
  /* Accessibility survey modal */
  .accessibility-survey-modal .modal-content {
    width: 100% !important;
    height: 100% !important;
    max-height: 100vh !important;
    border-radius: 0 !important;
    margin: 0 !important;
  }
  
  .survey-grid {
    grid-template-columns: 1fr !important;
  }
}

/* ============================================
   REPORTS.HTML SPECIFIC MOBILE FIXES
   ============================================ */
@media (max-width: 767px) {
  .page-container {
    padding: 16px !important;
  }
  
  .page-header h1 {
    font-size: 1.5rem !important;
  }
  
  .page-header p {
    font-size: 0.9rem !important;
  }
  
  /* Stats grid */
  .stats-grid {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 12px !important;
  }
  
  .stat-card {
    padding: 16px !important;
  }
  
  .stat-value {
    font-size: 1.5rem !important;
  }
  
  .stat-label {
    font-size: 0.75rem !important;
  }
  
  /* Filters */
  .filters-section {
    padding: 16px !important;
  }
  
  .filters-grid {
    grid-template-columns: 1fr !important;
    gap: 12px !important;
  }
  
  /* Map section */
  .map-section {
    height: 300px !important;
  }
  
  /* Report cards */
  .reports-grid {
    grid-template-columns: 1fr !important;
  }
  
  .report-card {
    padding: 16px !important;
  }
  
  /* Report form modal */
  .report-modal .modal-content {
    width: 100% !important;
    max-height: 100vh !important;
    border-radius: 0 !important;
    margin: 0 !important;
  }
}

/* ============================================
   PROFILE.HTML SPECIFIC MOBILE FIXES
   ============================================ */
@media (max-width: 767px) {
  .profile-header {
    padding: 16px !important;
    padding-top: 60px !important;
  }
  
  .header-top {
    margin-bottom: 16px !important;
  }
  
  .profile-card {
    flex-direction: column !important;
    text-align: center !important;
  }
  
  .profile-avatar {
    width: 80px !important;
    height: 80px !important;
    font-size: 2rem !important;
    margin-bottom: 12px !important;
  }
  
  .profile-name {
    font-size: 1.25rem !important;
  }
  
  .profile-email {
    font-size: 0.9rem !important;
  }
  
  .profile-content {
    padding: 16px !important;
  }
  
  .profile-section {
    padding: 16px !important;
    margin-bottom: 16px !important;
  }
  
  .section-title {
    font-size: 1.1rem !important;
  }
  
  /* Stats row */
  .stats-row {
    flex-wrap: wrap !important;
    gap: 12px !important;
  }
  
  .stat-item {
    flex: 1 1 45% !important;
    min-width: 120px !important;
  }
  
  /* Action buttons */
  .action-buttons {
    flex-direction: column !important;
    gap: 12px !important;
  }
  
  .action-buttons .btn {
    width: 100% !important;
  }
  
  /* Danger zone */
  .danger-zone {
    padding: 16px !important;
  }
  
  .danger-btn {
    width: 100% !important;
  }
}

/* ============================================
   AUTH MODAL MOBILE FIXES (All Pages)
   ============================================ */
@media (max-width: 767px) {
  .auth-modal {
    align-items: flex-end !important;
  }
  
  .auth-modal-container {
    width: 100% !important;
    max-width: 100% !important;
    max-height: 90vh !important;
    margin: 0 !important;
    border-radius: 20px 20px 0 0 !important;
    padding: 24px 20px !important;
  }
  
  .auth-modal-header h2 {
    font-size: 1.25rem !important;
  }
  
  .auth-form-header h3 {
    font-size: 1.1rem !important;
  }
  
  .auth-form-header p {
    font-size: 0.9rem !important;
  }
  
  .input-group input {
    padding: 14px 16px !important;
    font-size: 16px !important; /* Prevents iOS zoom */
  }
  
  .auth-submit-btn {
    padding: 14px !important;
    font-size: 1rem !important;
  }
}

/* ============================================
   TRAIL GUIDE MODAL MOBILE FIXES
   ============================================ */
@media (max-width: 767px) {
  .trail-guide-modal .modal-content {
    width: 100% !important;
    height: 100% !important;
    max-height: 100vh !important;
    border-radius: 0 !important;
    margin: 0 !important;
    padding: 16px !important;
  }
  
  .guide-header {
    flex-direction: column !important;
    gap: 12px !important;
  }
  
  .guide-meta {
    flex-wrap: wrap !important;
    gap: 8px !important;
  }
  
  .guide-section {
    padding: 16px !important;
  }
  
  .accessibility-grid {
    grid-template-columns: 1fr !important;
  }
  
  .photo-gallery {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}

/* ============================================
   TOUCH OPTIMIZATIONS
   ============================================ */
@media (hover: none) and (pointer: coarse) {
  /* Remove hover effects on touch devices */
  .btn:hover,
  .nav-link:hover,
  .card:hover,
  .nav-card:hover {
    transform: none !important;
    box-shadow: inherit !important;
  }
  
  /* Add active states instead */
  .btn:active,
  .nav-link:active,
  .card:active,
  .nav-card:active {
    transform: scale(0.98) !important;
    opacity: 0.9 !important;
  }
  
  /* Larger touch targets for interactive elements */
  .close-btn,
  .modal-close,
  .auth-modal-close {
    min-width: 44px !important;
    min-height: 44px !important;
    padding: 12px !important;
  }
}

/* ============================================
   LANDSCAPE MOBILE FIXES
   ============================================ */
@media (max-width: 896px) and (orientation: landscape) {
  /* Reduce vertical spacing in landscape */
  .hero-section {
    min-height: auto !important;
    padding: 40px 16px !important;
  }
  
  .hero-title {
    font-size: 1.5rem !important;
  }
  
  /* Make modals scrollable */
  .modal-content,
  .auth-modal-container {
    max-height: 80vh !important;
    overflow-y: auto !important;
  }
  
  /* Tracker adjustments - bottom-nav only, not map-container */
  .bottom-nav {
    height: 50px !important;
    padding: 6px 12px !important;
  }
}

/* ============================================
   PRINT STYLES
   ============================================ */
@media print {
  .top-nav,
  .unified-nav,
  .bottom-nav,
  .floating-left,
  .floating-right,
  .menu-toggle,
  .high-contrast-toggle {
    display: none !important;
  }
  
  body {
    padding-top: 0 !important;
  }
  
  .modal {
    position: static !important;
    display: block !important;
  }
  
  .modal-content {
    box-shadow: none !important;
    border: 1px solid #ccc !important;
  }
}
