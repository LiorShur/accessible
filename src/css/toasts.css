/* ==============================================
   ACCESS NATURE - TOAST NOTIFICATIONS (FIXED)
   Non-blocking notification system
   
   FIXES APPLIED:
   - Uses z-index CSS variables from design-system.css
   - Removed hardcoded z-index values
   
   File: src/css/toasts.css
   Version: 2.0
   ============================================== */

/* ==============================================
   TOAST CONTAINER
   ============================================== */

.toast-container {
  position: fixed;
  z-index: var(--z-toast);
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
  pointer-events: none;
  max-width: var(--toast-width);
  width: 100%;
}

/* Position variants */
.toast-container.top-right {
  top: var(--space-md);
  right: var(--space-md);
}

.toast-container.top-left {
  top: var(--space-md);
  left: var(--space-md);
}

.toast-container.top-center {
  top: var(--space-md);
  left: 50%;
  transform: translateX(-50%);
}

.toast-container.bottom-right {
  bottom: var(--space-md);
  right: var(--space-md);
}

.toast-container.bottom-left {
  bottom: var(--space-md);
  left: var(--space-md);
}

.toast-container.bottom-center {
  bottom: var(--space-md);
  left: 50%;
  transform: translateX(-50%);
}

/* ==============================================
   INDIVIDUAL TOAST
   ============================================== */

.toast {
  display: flex;
  align-items: flex-start;
  gap: var(--space-sm);
  padding: var(--space-md);
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  border-left: 4px solid var(--color-border);
  pointer-events: auto;
  opacity: 0;
  transform: translateX(100%);
  transition: 
    opacity var(--transition-base),
    transform var(--transition-base);
  max-width: 100%;
}

.toast.show {
  opacity: 1;
  transform: translateX(0);
}

.toast.hide {
  opacity: 0;
  transform: translateX(100%);
}

/* Left-positioned toasts */
.toast-container.top-left .toast,
.toast-container.bottom-left .toast {
  transform: translateX(-100%);
}

.toast-container.top-left .toast.show,
.toast-container.bottom-left .toast.show {
  transform: translateX(0);
}

.toast-container.top-left .toast.hide,
.toast-container.bottom-left .toast.hide {
  transform: translateX(-100%);
}

/* Center-positioned toasts */
.toast-container.top-center .toast,
.toast-container.bottom-center .toast {
  transform: translateY(-20px);
}

.toast-container.top-center .toast.show,
.toast-container.bottom-center .toast.show {
  transform: translateY(0);
}

.toast-container.top-center .toast.hide,
.toast-container.bottom-center .toast.hide {
  transform: translateY(-20px);
}

/* ==============================================
   TOAST ICON
   ============================================== */

.toast-icon {
  flex-shrink: 0;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
}

/* ==============================================
   TOAST CONTENT
   ============================================== */

.toast-content {
  flex: 1;
  min-width: 0;
}

.toast-title {
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-primary);
  margin-bottom: var(--space-xs);
  font-size: var(--font-size-base);
}

.toast-message {
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  line-height: var(--line-height-base);
  word-wrap: break-word;
}

/* Single line toast (no title) */
.toast:not(:has(.toast-title)) .toast-message {
  color: var(--color-text-primary);
  font-size: var(--font-size-base);
}

/* ==============================================
   TOAST CLOSE BUTTON
   ============================================== */

.toast-close {
  flex-shrink: 0;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  background: transparent;
  border-radius: var(--radius-md);
  cursor: pointer;
  color: var(--color-text-hint);
  font-size: 18px;
  padding: 0;
  margin: -4px -4px -4px 0;
  transition: 
    background-color var(--transition-fast),
    color var(--transition-fast);
}

.toast-close:hover {
  background-color: var(--color-surface-hover);
  color: var(--color-text-secondary);
}

.toast-close:focus {
  outline: none;
  box-shadow: var(--shadow-focus);
}

/* ==============================================
   TOAST TYPE VARIANTS
   ============================================== */

/* Success */
.toast--success {
  border-left-color: var(--color-success);
}

.toast--success .toast-icon {
  color: var(--color-success);
}

/* Error */
.toast--error {
  border-left-color: var(--color-danger);
}

.toast--error .toast-icon {
  color: var(--color-danger);
}

/* Warning */
.toast--warning {
  border-left-color: var(--color-warning);
}

.toast--warning .toast-icon {
  color: var(--color-warning);
}

/* Info */
.toast--info {
  border-left-color: var(--color-info);
}

.toast--info .toast-icon {
  color: var(--color-info);
}

/* Loading */
.toast--loading {
  border-left-color: var(--color-primary);
}

.toast--loading .toast-icon {
  color: var(--color-primary);
}

.toast--loading .toast-spinner {
  width: 20px;
  height: 20px;
  border: 2px solid var(--color-border);
  border-top-color: var(--color-primary);
  border-radius: var(--radius-full);
  animation: toast-spin 0.8s linear infinite;
}

@keyframes toast-spin {
  to {
    transform: rotate(360deg);
  }
}

/* ==============================================
   TOAST PROGRESS BAR
   ============================================== */

.toast-progress {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: var(--color-border-light);
  border-radius: 0 0 var(--radius-lg) var(--radius-lg);
  overflow: hidden;
}

.toast-progress-bar {
  height: 100%;
  background: currentColor;
  transform-origin: left;
  animation: toast-progress var(--toast-duration, 4000ms) linear forwards;
}

@keyframes toast-progress {
  from {
    transform: scaleX(1);
  }
  to {
    transform: scaleX(0);
  }
}

.toast--success .toast-progress-bar {
  background: var(--color-success);
}

.toast--error .toast-progress-bar {
  background: var(--color-danger);
}

.toast--warning .toast-progress-bar {
  background: var(--color-warning);
}

.toast--info .toast-progress-bar {
  background: var(--color-info);
}

/* Pause progress on hover */
.toast:hover .toast-progress-bar {
  animation-play-state: paused;
}

/* ==============================================
   TOAST ACTION BUTTON
   ============================================== */

.toast-actions {
  display: flex;
  gap: var(--space-sm);
  margin-top: var(--space-sm);
}

.toast-action {
  padding: var(--space-xs) var(--space-sm);
  border: none;
  background: transparent;
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  transition: background-color var(--transition-fast);
}

.toast-action:hover {
  background-color: var(--color-surface-hover);
}

.toast--success .toast-action {
  color: var(--color-success);
}

.toast--error .toast-action {
  color: var(--color-danger);
}

.toast--info .toast-action {
  color: var(--color-info);
}

/* ==============================================
   STACKED TOASTS
   ============================================== */

/* When multiple toasts, stack with offset */
.toast-container.stacked .toast:nth-child(n+2) {
  margin-top: calc(var(--space-sm) * -1);
  opacity: 0.9;
  transform: scale(0.95);
}

.toast-container.stacked .toast:nth-child(n+3) {
  opacity: 0.8;
  transform: scale(0.9);
}

.toast-container.stacked .toast:nth-child(n+4) {
  display: none;
}

/* ==============================================
   RESPONSIVE - MOBILE
   ============================================== */

@media (max-width: 640px) {
  .toast-container {
    left: var(--space-sm);
    right: var(--space-sm);
    max-width: none;
    transform: none;
  }

  .toast-container.top-right,
  .toast-container.top-left,
  .toast-container.top-center {
    top: var(--space-sm);
    left: var(--space-sm);
    right: var(--space-sm);
  }

  .toast-container.bottom-right,
  .toast-container.bottom-left,
  .toast-container.bottom-center {
    bottom: calc(var(--space-sm) + 80px); /* Above bottom nav */
    left: var(--space-sm);
    right: var(--space-sm);
  }

  .toast {
    padding: var(--space-sm) var(--space-md);
  }

  /* Mobile animation - slide from top/bottom */
  .toast-container.top-right .toast,
  .toast-container.top-left .toast,
  .toast-container.top-center .toast {
    transform: translateY(-100%);
  }

  .toast-container.bottom-right .toast,
  .toast-container.bottom-left .toast,
  .toast-container.bottom-center .toast {
    transform: translateY(100%);
  }

  .toast.show {
    transform: translateY(0);
  }
}

/* ==============================================
   SAFE AREA INSETS (notched devices)
   ============================================== */

@supports (padding-top: env(safe-area-inset-top)) {
  .toast-container.top-right,
  .toast-container.top-left,
  .toast-container.top-center {
    top: calc(var(--space-sm) + env(safe-area-inset-top));
  }

  .toast-container.bottom-right,
  .toast-container.bottom-left,
  .toast-container.bottom-center {
    bottom: calc(var(--space-sm) + env(safe-area-inset-bottom) + 80px);
  }
}

/* ==============================================
   DARK MODE
   ============================================== */

[data-theme="dark"] .toast,
body.dark-mode .toast {
  background: var(--color-surface);
  box-shadow: var(--shadow-xl);
}

[data-theme="dark"] .toast-progress,
body.dark-mode .toast-progress {
  background: var(--color-border);
}

/* ==============================================
   ACCESSIBILITY
   ============================================== */

/* Screen reader announcements */
.toast[role="alert"] {
  /* Ensure toasts are announced */
}

/* High contrast mode */
@media (prefers-contrast: high) {
  .toast {
    border: 2px solid var(--color-text-primary);
    border-left-width: 4px;
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .toast {
    transition: opacity var(--transition-fast);
    transform: none;
  }

  .toast.show {
    transform: none;
  }

  .toast.hide {
    transform: none;
  }

  .toast-progress-bar {
    animation: none;
  }

  .toast--loading .toast-spinner {
    animation: none;
  }
}
